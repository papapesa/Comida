module minecraft3d (
    input clk,
    input reset,
    input btn_forward,
    input btn_left,
    input btn_right,
    output [7:0] player_pos,   // {x[2:0], y[2:0], z[1:0]}
    output [1:0] block_seen    // tipo de bloco à frente
);

    // Posição do jogador
    reg [2:0] x = 3;
    reg [2:0] y = 0;
    reg [2:0] z = 3;
    reg [1:0] facing = 0; // 0=N, 1=E, 2=S, 3=W

    // Mundo 8x8x8: 512 blocos (2 bits por bloco)
    reg [1:0] world [0:511];

    // Inicialização do mundo
    integer i;
    initial begin
        for (i = 0; i < 512; i = i + 1)
            world[i] = 2'b00; // Ar
        // Piso de pedra no nível y=0
        for (i = 0; i < 64; i = i + 1)
            world[i] = 2'b10; // Pedra
    end

    // Movimento do jogador
    always @(posedge clk or posedge reset) begin
        if (reset) begin
            x <= 3;
            y <= 0;
            z <= 3;
            facing <= 0;
        end else begin
            if (btn_left)
                facing <= (facing == 0) ? 3 : facing - 1;
            if (btn_right)
                facing <= (facing == 3) ? 0 : facing + 1;
            if (btn_forward) begin
                case (facing)
                    0: if (z > 0) z <= z - 1;
                    1: if (x < 7) x <= x + 1;
                    2: if (z < 7) z <= z + 1;
                    3: if (x > 0) x <= x - 1;
                endcase
            end
        end
    end

    // Cálculo do bloco à frente
    reg [2:0] fx, fy, fz;
    wire [8:0] index;
    always @(*) begin
        fx = x; fy = y; fz = z;
        case (facing)
            0: if (z > 0) fz = z - 1;
            1: if (x < 7) fx = x + 1;
            2: if (z < 7) fz = z + 1;
            3: if (x > 0) fx = x - 1;
        endcase
    end
    assign index = (fy * 64) + (fz * 8) + fx;
    assign block_seen = world[index];
    assign player_pos = {x[2:0], y[2:0], z[1:0]};

endmodule
